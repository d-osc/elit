import {
  div, h1, h2, h3, p, ul, li, pre, code, strong, em, a
} from 'elit';
import { codeBlock } from '../../highlight';
import type { BlogPostDetail } from '../blogContent';

export const blog19: BlogPostDetail = {
  id: '19',
  title: {
    en: 'Complete Guide to Elit Configuration',
    th: '‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Elit ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô'
  },
  date: '2024-04-20',
  author: 'n-devs',
  tags: ['Configuration', 'elit.config', 'Setup', 'Advanced'],
  content: {
    en: div(
      p('Master ', strong('Elit configuration'), ' to unlock the full power of your development workflow. This comprehensive guide covers ', em('dev server, multi-client setup, build configurations, proxy, workers, API, middleware'), ', and advanced features.'),

      h2('Configuration File'),
      p('Elit supports multiple configuration file formats:'),
      ul(
        li(strong('elit.config.ts'), ' - TypeScript (recommended, with type safety)'),
        li(strong('elit.config.js'), ' or ', strong('elit.config.mjs'), ' - JavaScript ES modules'),
        li(strong('elit.config.cjs'), ' - CommonJS'),
        li(strong('elit.config.json'), ' - JSON format')
      ),

      h2('Basic Configuration'),
      h3('Simple Setup'),
      pre(code(...codeBlock(`// elit.config.ts
import { resolve } from 'path';

export default {
  dev: {
    port: 3000,
    host: 'localhost',
    root: './src',
    basePath: '/app',
    open: true,
    logging: true
  },
  build: {
    entry: 'src/main.ts',
    outDir: 'dist',
    outFile: 'bundle.js',
    format: 'esm',
    minify: true,
    sourcemap: false
  },
  preview: {
    port: 4173,
    root: 'dist',
    basePath: '/app'
  }
}`))),

      h2('Development Server Configuration'),
      h3('Single Client Setup'),
      pre(code(...codeBlock(`export default {
  dev: {
    port: 3000,
    host: 'localhost',
    root: './src',
    basePath: '/app',
    open: true,
    logging: true,
    https: false,

    // Watch patterns
    watch: ['src/**/*.ts', 'public/**/*'],
    ignore: ['node_modules/**', '**/*.test.ts']
  }
}`))),

      h3('Multi-Client Setup'),
      p('Run multiple applications on the same port with different base paths:'),
      pre(code(...codeBlock(`export default {
  dev: {
    port: 3000,
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        watch: ['app1/**/*.ts'],
        ssr: () => '<h1>App 1</h1>'
      },
      {
        root: './app2',
        basePath: '/app2',
        watch: ['app2/**/*.ts'],
        ssr: () => '<h1>App 2</h1>'
      }
    ]
  }
}`))),

      h2('Build Configuration'),
      h3('Single Build'),
      pre(code(...codeBlock(`export default {
  build: {
    entry: 'src/main.ts',
    outDir: 'dist',
    outFile: 'bundle.js',
    format: 'esm',      // 'esm', 'cjs', 'iife'
    target: 'es2020',   // es2015-es2022, esnext
    platform: 'browser', // 'browser', 'node', 'neutral'
    minify: true,
    sourcemap: false,
    treeshake: true,
    basePath: '/app',

    // External dependencies (not bundled)
    external: ['react', 'react-dom'],

    // Environment variables
    env: {
      API_URL: 'https://api.example.com',
      VERSION: '1.0.0'
    },

    // Copy static files
    copy: [
      { from: 'index.html', to: 'index.html' },
      { from: 'public/**/*', to: 'public' }
    ]
  }
}`))),

      h3('Multiple Builds'),
      p('Build multiple entries in a single command:'),
      pre(code(...codeBlock(`export default {
  build: [
    // Main application
    {
      entry: 'src/app.ts',
      outDir: 'dist',
      outFile: 'app.js',
      format: 'esm',
      minify: true
    },
    // Admin panel
    {
      entry: 'src/admin.ts',
      outDir: 'dist',
      outFile: 'admin.js',
      format: 'esm',
      minify: true
    },
    // Web Worker
    {
      entry: 'src/worker.ts',
      outDir: 'dist/workers',
      outFile: 'worker.js',
      format: 'esm',
      platform: 'browser'
    }
  ]
}

// Run all builds sequentially:
// npx elit build`))),

      h2('Proxy Configuration'),
      p('Forward API requests to backend servers during development:'),

      h3('Global Proxy'),
      pre(code(...codeBlock(`export default {
  dev: {
    port: 3000,
    proxy: [
      {
        context: '/api',
        target: 'http://localhost:8080',
        changeOrigin: true
      },
      {
        context: '/graphql',
        target: 'http://localhost:4000',
        changeOrigin: true,
        pathRewrite: { '^/graphql': '/api/graphql' },
        headers: {
          'X-Custom-Header': 'value'
        },
        ws: true  // Enable WebSocket proxying
      }
    ]
  }
}`))),

      h3('Client-Specific Proxy'),
      pre(code(...codeBlock(`export default {
  dev: {
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        proxy: [
          {
            context: '/api',
            target: 'http://localhost:8080',
            changeOrigin: true
          }
        ]
      },
      {
        root: './app2',
        basePath: '/app2',
        proxy: [
          {
            context: '/graphql',
            target: 'http://localhost:4000',
            changeOrigin: true
          }
        ]
      }
    ]
  }
}

// Proxy Priority:
// 1. Client-specific proxy (clients[].proxy)
// 2. Global proxy (dev.proxy)`))),

      h2('Web Workers Configuration'),
      p('Configure Web Workers for background processing:'),

      h3('Global Workers'),
      pre(code(...codeBlock(`export default {
  dev: {
    worker: [
      {
        path: 'workers/shared-worker.js',
        name: 'sharedWorker',
        type: 'module'  // 'module' or 'classic'
      }
    ]
  }
}`))),

      h3('Client-Specific Workers'),
      pre(code(...codeBlock(`export default {
  dev: {
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        worker: [
          {
            path: 'workers/data-processor.js',
            name: 'dataProcessor',
            type: 'module'
          }
        ]
      }
    ]
  }
}

// Both global and client-specific workers will be loaded`))),

      h2('REST API Configuration'),
      p('Define REST API endpoints using the built-in router:'),

      h3('Global API'),
      pre(code(...codeBlock(`import { router } from 'elit/server';

export default {
  dev: {
    api: router()
      .get('/api/users', (req, res) => {
        res.json({ users: [] });
      })
      .post('/api/users', (req, res) => {
        res.json({ message: 'User created' });
      })
      .get('/api/users/:id', (req, res) => {
        res.json({ id: req.params.id });
      })
  }
}`))),

      h3('Client-Specific API'),
      p('Each client can have its own API endpoints. API paths are automatically prefixed with the client\'s basePath:'),
      pre(code(...codeBlock(`import { router } from 'elit/server';

export default {
  dev: {
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        // API routes are prefixed with basePath
        // This route becomes: /app1/api/health
        api: router()
          .get('/api/health', (req, res) => {
            res.json({ status: 'ok', app: 'app1' });
          })
      },
      {
        root: './app2',
        basePath: '/app2',
        // This route becomes: /app2/api/status
        api: router()
          .get('/api/status', (req, res) => {
            res.json({ status: 'running', app: 'app2' });
          })
      }
    ]
  }
}`))),

      h2('Middleware Configuration'),
      p('Add custom middleware for request processing:'),

      h3('Global Middleware'),
      pre(code(...codeBlock(`export default {
  dev: {
    middleware: [
      // Logging middleware
      (req, res, next) => {
        console.log(\`[\${new Date().toISOString()}] \${req.method} \${req.url}\`);
        next();
      },
      // Custom headers
      (req, res, next) => {
        res.setHeader('X-Powered-By', 'Elit');
        next();
      },
      // Authentication check
      (req, res, next) => {
        if (req.url.startsWith('/admin') && !req.headers.authorization) {
          res.writeHead(401);
          res.end('Unauthorized');
          return;
        }
        next();
      }
    ]
  }
}`))),

      h3('Client-Specific Middleware'),
      pre(code(...codeBlock(`export default {
  dev: {
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        middleware: [
          (req, res, next) => {
            console.log('App1 middleware:', req.url);
            next();
          }
        ]
      }
    ]
  }
}

// Middleware Priority:
// 1. Client-specific middleware (runs first)
// 2. Global middleware (runs second)`))),

      h2('Server-Side Rendering (SSR)'),
      p('Configure SSR for initial page load:'),
      pre(code(...codeBlock(`import { div, h1 } from 'elit';

export default {
  dev: {
    ssr: () => {
      // Return VNode or HTML string
      return div({ className: 'app' },
        h1('Server-Rendered Content')
      );
    }
  },

  // Client-specific SSR
  // clients: [
  //   {
  //     root: './app1',
  //     basePath: '/app1',
  //     ssr: () => '<h1>App 1 SSR</h1>'
  //   }
  // ]
}`))),

      h2('Preview Configuration'),
      p('Preview mode supports all dev features for production builds:'),
      pre(code(...codeBlock(`import { router } from 'elit/server';

export default {
  preview: {
    port: 4173,
    host: 'localhost',
    root: 'dist',
    basePath: '/app',
    https: false,
    open: true,
    logging: true,

    // API endpoints
    api: router()
      .get('/api/health', (req, res) => {
        res.json({ status: 'ok' });
      }),

    // Custom middleware
    middleware: [
      (req, res, next) => {
        console.log('Preview request:', req.url);
        next();
      }
    ],

    // SSR
    ssr: () => '<h1>Preview SSR</h1>',

    // Proxy
    proxy: [
      {
        context: '/api',
        target: 'http://localhost:8080'
      }
    ],

    // Workers
    worker: [
      {
        path: 'workers/cache-worker.js',
        type: 'module'
      }
    ],

    // Multi-client preview
    // clients: [...]
  }
}`))),

      h2('Complete Example'),
      p('A production-ready configuration:'),
      pre(code(...codeBlock(`import { resolve, dirname } from 'path';
import { fileURLToPath } from 'url';
import { router } from 'elit/server';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

export default {
  // Development server
  dev: {
    port: 3000,
    host: 'localhost',
    open: true,
    logging: true,

    // Multi-client setup
    clients: [
      {
        root: resolve(__dirname, 'apps/web'),
        basePath: '/web',
        watch: ['apps/web/**/*.ts'],
        proxy: [
          {
            context: '/api',
            target: 'http://localhost:8080',
            changeOrigin: true
          }
        ],
        worker: [
          {
            path: 'workers/web-worker.js',
            type: 'module'
          }
        ],
        api: router()
          .get('/api/health', (req, res) => {
            res.json({ status: 'ok' });
          }),
        middleware: [
          (req, res, next) => {
            console.log('Web app:', req.url);
            next();
          }
        ],
        ssr: () => '<h1>Web App</h1>'
      },
      {
        root: resolve(__dirname, 'apps/admin'),
        basePath: '/admin',
        watch: ['apps/admin/**/*.ts'],
        api: router()
          .get('/api/stats', (req, res) => {
            res.json({ stats: {} });
          })
      }
    ],

    // Global configuration
    proxy: [
      {
        context: '/shared-api',
        target: 'http://localhost:9000',
        changeOrigin: true
      }
    ],
    worker: [
      {
        path: 'workers/shared-worker.js',
        name: 'sharedWorker',
        type: 'module'
      }
    ]
  },

  // Build configuration (multiple builds)
  build: [
    {
      entry: resolve(__dirname, 'apps/web/main.ts'),
      outDir: resolve(__dirname, 'dist/web'),
      outFile: 'bundle.js',
      format: 'esm',
      target: 'es2020',
      minify: true,
      sourcemap: false,
      basePath: '/web',
      copy: [
        {
          from: 'apps/web/index.html',
          to: 'index.html',
          transform: (content, config) => {
            return content.replace(
              '<head>',
              \`<head>\\n  <base href="\${config.basePath}/">\`
            );
          }
        }
      ]
    },
    {
      entry: resolve(__dirname, 'apps/admin/main.ts'),
      outDir: resolve(__dirname, 'dist/admin'),
      outFile: 'bundle.js',
      format: 'esm',
      target: 'es2020',
      minify: true,
      basePath: '/admin'
    }
  ],

  // Preview server
  preview: {
    port: 4173,
    host: 'localhost',
    open: true,
    logging: true,

    clients: [
      {
        root: resolve(__dirname, 'dist/web'),
        basePath: '/web'
      },
      {
        root: resolve(__dirname, 'dist/admin'),
        basePath: '/admin'
      }
    ]
  }
}`))),

      h2('Environment Variables'),
      p('Elit automatically loads environment variables from .env files:'),
      pre(code(...codeBlock(`# .env.development
MODE=development
VITE_API_URL=http://localhost:8080
VITE_DEBUG=true

# .env.production
MODE=production
VITE_API_URL=https://api.production.com
VITE_DEBUG=false`))),

      p('Access in your code:'),
      pre(code(...codeBlock(`// Only variables prefixed with VITE_ are exposed to client
console.log(import.meta.env.VITE_API_URL);
console.log(import.meta.env.VITE_DEBUG);`))),

      h2('CLI Commands'),
      p('Use Elit CLI with your configuration:'),
      pre(code(...codeBlock(`# Development
npx elit dev                    # Uses config file
npx elit dev --port 8080        # Override config

# Build
npx elit build                  # Runs all builds from config
npx elit build --entry src/app.ts  # Single build (ignores config)

# Preview
npx elit preview                # Uses config file
npx elit preview --port 5000    # Override config`))),

      h2('Best Practices'),
      ul(
        li(strong('Use TypeScript config'), ' for better type safety and autocompletion'),
        li(strong('Separate concerns'), ' - Use multi-client setup for different apps'),
        li(strong('Environment-specific configs'), ' - Create separate configs for dev/prod'),
        li(strong('Organize builds'), ' - Use multiple builds for different entry points'),
        li(strong('Leverage middleware'), ' - Add logging, auth, and custom processing'),
        li(strong('Configure proxy carefully'), ' - Use client-specific proxy when needed'),
        li(strong('Use SSR wisely'), ' - Only for initial load optimization'),
        li(strong('Test preview mode'), ' - Always test production builds before deploying')
      ),

      h2('Next Steps'),
      ul(
        li(a({ href: '/elit/blog/18' }, 'Complete Guide to Elit')),
        li(a({ href: '/elit/blog/17' }, 'Hot Module Replacement with Elit')),
        li(a({ href: '/elit/docs' }, 'Full Documentation')),
        li(a({ href: '/elit/api' }, 'API Reference'))
      ),

      p('Ready to build amazing applications with Elit! üöÄ')
    ),
    th: div(
      p('‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç ', strong('‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Elit'), ' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏û‡∏•‡∏±‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á workflow ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏° ', em('dev server, multi-client setup, build configurations, proxy, workers, API, middleware'), ' ‡πÅ‡∏•‡∏∞‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á'),

      h2('‡πÑ‡∏ü‡∏•‡πå Configuration'),
      p('Elit ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå config:'),
      ul(
        li(strong('elit.config.ts'), ' - TypeScript (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‡∏°‡∏µ type safety)'),
        li(strong('elit.config.js'), ' ‡∏´‡∏£‡∏∑‡∏≠ ', strong('elit.config.mjs'), ' - JavaScript ES modules'),
        li(strong('elit.config.cjs'), ' - CommonJS'),
        li(strong('elit.config.json'), ' - JSON format')
      ),

      h2('‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô'),
      h3('Setup ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢'),
      pre(code(...codeBlock(`// elit.config.ts
import { resolve } from 'path';

export default {
  dev: {
    port: 3000,
    host: 'localhost',
    root: './src',
    basePath: '/app',
    open: true,
    logging: true
  },
  build: {
    entry: 'src/main.ts',
    outDir: 'dist',
    outFile: 'bundle.js',
    format: 'esm',
    minify: true,
    sourcemap: false
  },
  preview: {
    port: 4173,
    root: 'dist',
    basePath: '/app'
  }
}`))),

      h2('‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Development Server'),
      h3('Single Client Setup'),
      pre(code(...codeBlock(`export default {
  dev: {
    port: 3000,
    host: 'localhost',
    root: './src',
    basePath: '/app',
    open: true,
    logging: true,
    https: false,

    // Watch patterns
    watch: ['src/**/*.ts', 'public/**/*'],
    ignore: ['node_modules/**', '**/*.test.ts']
  }
}`))),

      h3('Multi-Client Setup'),
      p('‡∏£‡∏±‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏≠‡∏û‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏ö‡∏ô port ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢ base path ‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô:'),
      pre(code(...codeBlock(`export default {
  dev: {
    port: 3000,
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        watch: ['app1/**/*.ts'],
        ssr: () => '<h1>App 1</h1>'
      },
      {
        root: './app2',
        basePath: '/app2',
        watch: ['app2/**/*.ts'],
        ssr: () => '<h1>App 2</h1>'
      }
    ]
  }
}`))),

      h2('‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Build'),
      h3('Single Build'),
      pre(code(...codeBlock(`export default {
  build: {
    entry: 'src/main.ts',
    outDir: 'dist',
    outFile: 'bundle.js',
    format: 'esm',      // 'esm', 'cjs', 'iife'
    target: 'es2020',   // es2015-es2022, esnext
    platform: 'browser', // 'browser', 'node', 'neutral'
    minify: true,
    sourcemap: false,
    treeshake: true,
    basePath: '/app',

    // External dependencies (‡πÑ‡∏°‡πà bundle)
    external: ['react', 'react-dom'],

    // Environment variables
    env: {
      API_URL: 'https://api.example.com',
      VERSION: '1.0.0'
    },

    // Copy static files
    copy: [
      { from: 'index.html', to: 'index.html' },
      { from: 'public/**/*', to: 'public' }
    ]
  }
}`))),

      h3('Multiple Builds'),
      p('Build ‡∏´‡∏•‡∏≤‡∏¢ entries ‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß:'),
      pre(code(...codeBlock(`export default {
  build: [
    // Main application
    {
      entry: 'src/app.ts',
      outDir: 'dist',
      outFile: 'app.js',
      format: 'esm',
      minify: true
    },
    // Admin panel
    {
      entry: 'src/admin.ts',
      outDir: 'dist',
      outFile: 'admin.js',
      format: 'esm',
      minify: true
    },
    // Web Worker
    {
      entry: 'src/worker.ts',
      outDir: 'dist/workers',
      outFile: 'worker.js',
      format: 'esm',
      platform: 'browser'
    }
  ]
}

// ‡∏£‡∏±‡∏ô build ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö:
// npx elit build`))),

      h2('Proxy Configuration'),
      p('‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠ API requests ‡πÑ‡∏õ‡∏¢‡∏±‡∏á backend servers ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤:'),

      h3('Global Proxy'),
      pre(code(...codeBlock(`export default {
  dev: {
    port: 3000,
    proxy: [
      {
        context: '/api',
        target: 'http://localhost:8080',
        changeOrigin: true
      },
      {
        context: '/graphql',
        target: 'http://localhost:4000',
        changeOrigin: true,
        pathRewrite: { '^/graphql': '/api/graphql' },
        headers: {
          'X-Custom-Header': 'value'
        },
        ws: true  // ‡πÄ‡∏õ‡∏¥‡∏î WebSocket proxying
      }
    ]
  }
}`))),

      h3('Client-Specific Proxy'),
      pre(code(...codeBlock(`export default {
  dev: {
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        proxy: [
          {
            context: '/api',
            target: 'http://localhost:8080',
            changeOrigin: true
          }
        ]
      },
      {
        root: './app2',
        basePath: '/app2',
        proxy: [
          {
            context: '/graphql',
            target: 'http://localhost:4000',
            changeOrigin: true
          }
        ]
      }
    ]
  }
}

// ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á Proxy:
// 1. Client-specific proxy (clients[].proxy)
// 2. Global proxy (dev.proxy)`))),

      h2('Web Workers Configuration'),
      p('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Web Workers ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö background processing:'),

      h3('Global Workers'),
      pre(code(...codeBlock(`export default {
  dev: {
    worker: [
      {
        path: 'workers/shared-worker.js',
        name: 'sharedWorker',
        type: 'module'  // 'module' ‡∏´‡∏£‡∏∑‡∏≠ 'classic'
      }
    ]
  }
}`))),

      h3('Client-Specific Workers'),
      pre(code(...codeBlock(`export default {
  dev: {
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        worker: [
          {
            path: 'workers/data-processor.js',
            name: 'dataProcessor',
            type: 'module'
          }
        ]
      }
    ]
  }
}

// Global ‡πÅ‡∏•‡∏∞ client-specific workers ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà`))),

      h2('REST API Configuration'),
      p('‡∏Å‡∏≥‡∏´‡∏ô‡∏î REST API endpoints ‡∏î‡πâ‡∏ß‡∏¢ router ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ:'),

      h3('Global API'),
      pre(code(...codeBlock(`import { router } from 'elit/server';

export default {
  dev: {
    api: router()
      .get('/api/users', (req, res) => {
        res.json({ users: [] });
      })
      .post('/api/users', (req, res) => {
        res.json({ message: 'User created' });
      })
      .get('/api/users/:id', (req, res) => {
        res.json({ id: req.params.id });
      })
  }
}`))),

      h3('Client-Specific API'),
      p('‡πÅ‡∏ï‡πà‡∏•‡∏∞ client ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏µ API endpoints ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ API paths ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å prefix ‡∏î‡πâ‡∏ß‡∏¢ basePath ‡∏Ç‡∏≠‡∏á client ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:'),
      pre(code(...codeBlock(`import { router } from 'elit/server';

export default {
  dev: {
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        // API routes ‡∏à‡∏∞ prefix ‡∏î‡πâ‡∏ß‡∏¢ basePath
        // route ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô: /app1/api/health
        api: router()
          .get('/api/health', (req, res) => {
            res.json({ status: 'ok', app: 'app1' });
          })
      },
      {
        root: './app2',
        basePath: '/app2',
        // route ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô: /app2/api/status
        api: router()
          .get('/api/status', (req, res) => {
            res.json({ status: 'running', app: 'app2' });
          })
      }
    ]
  }
}`))),

      h2('Middleware Configuration'),
      p('‡πÄ‡∏û‡∏¥‡πà‡∏° middleware ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö request processing:'),

      h3('Global Middleware'),
      pre(code(...codeBlock(`export default {
  dev: {
    middleware: [
      // Logging middleware
      (req, res, next) => {
        console.log(\`[\${new Date().toISOString()}] \${req.method} \${req.url}\`);
        next();
      },
      // Custom headers
      (req, res, next) => {
        res.setHeader('X-Powered-By', 'Elit');
        next();
      },
      // Authentication check
      (req, res, next) => {
        if (req.url.startsWith('/admin') && !req.headers.authorization) {
          res.writeHead(401);
          res.end('Unauthorized');
          return;
        }
        next();
      }
    ]
  }
}`))),

      h3('Client-Specific Middleware'),
      pre(code(...codeBlock(`export default {
  dev: {
    clients: [
      {
        root: './app1',
        basePath: '/app1',
        middleware: [
          (req, res, next) => {
            console.log('App1 middleware:', req.url);
            next();
          }
        ]
      }
    ]
  }
}

// ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á Middleware:
// 1. Client-specific middleware (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô)
// 2. Global middleware (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡∏°‡∏≤)`))),

      h2('Server-Side Rendering (SSR)'),
      p('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SSR ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å:'),
      pre(code(...codeBlock(`import { div, h1 } from 'elit';

export default {
  dev: {
    ssr: () => {
      // return VNode ‡∏´‡∏£‡∏∑‡∏≠ HTML string
      return div({ className: 'app' },
        h1('Server-Rendered Content')
      );
    }
  },

  // Client-specific SSR
  // clients: [
  //   {
  //     root: './app1',
  //     basePath: '/app1',
  //     ssr: () => '<h1>App 1 SSR</h1>'
  //   }
  // ]
}`))),

      h2('Preview Configuration'),
      p('Preview mode ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á dev mode ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production builds:'),
      pre(code(...codeBlock(`import { router } from 'elit/server';

export default {
  preview: {
    port: 4173,
    host: 'localhost',
    root: 'dist',
    basePath: '/app',
    https: false,
    open: true,
    logging: true,

    // API endpoints
    api: router()
      .get('/api/health', (req, res) => {
        res.json({ status: 'ok' });
      }),

    // Custom middleware
    middleware: [
      (req, res, next) => {
        console.log('Preview request:', req.url);
        next();
      }
    ],

    // SSR
    ssr: () => '<h1>Preview SSR</h1>',

    // Proxy
    proxy: [
      {
        context: '/api',
        target: 'http://localhost:8080'
      }
    ],

    // Workers
    worker: [
      {
        path: 'workers/cache-worker.js',
        type: 'module'
      }
    ],

    // Multi-client preview
    // clients: [...]
  }
}`))),

      h2('‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå'),
      p('Configuration ‡∏ó‡∏µ‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° production:'),
      pre(code(...codeBlock(`import { resolve, dirname } from 'path';
import { fileURLToPath } from 'url';
import { router } from 'elit/server';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

export default {
  // Development server
  dev: {
    port: 3000,
    host: 'localhost',
    open: true,
    logging: true,

    // Multi-client setup
    clients: [
      {
        root: resolve(__dirname, 'apps/web'),
        basePath: '/web',
        watch: ['apps/web/**/*.ts'],
        proxy: [
          {
            context: '/api',
            target: 'http://localhost:8080',
            changeOrigin: true
          }
        ],
        worker: [
          {
            path: 'workers/web-worker.js',
            type: 'module'
          }
        ],
        api: router()
          .get('/api/health', (req, res) => {
            res.json({ status: 'ok' });
          }),
        middleware: [
          (req, res, next) => {
            console.log('Web app:', req.url);
            next();
          }
        ],
        ssr: () => '<h1>Web App</h1>'
      },
      {
        root: resolve(__dirname, 'apps/admin'),
        basePath: '/admin',
        watch: ['apps/admin/**/*.ts'],
        api: router()
          .get('/api/stats', (req, res) => {
            res.json({ stats: {} });
          })
      }
    ],

    // Global configuration
    proxy: [
      {
        context: '/shared-api',
        target: 'http://localhost:9000',
        changeOrigin: true
      }
    ],
    worker: [
      {
        path: 'workers/shared-worker.js',
        name: 'sharedWorker',
        type: 'module'
      }
    ]
  },

  // Build configuration (multiple builds)
  build: [
    {
      entry: resolve(__dirname, 'apps/web/main.ts'),
      outDir: resolve(__dirname, 'dist/web'),
      outFile: 'bundle.js',
      format: 'esm',
      target: 'es2020',
      minify: true,
      sourcemap: false,
      basePath: '/web',
      copy: [
        {
          from: 'apps/web/index.html',
          to: 'index.html',
          transform: (content, config) => {
            return content.replace(
              '<head>',
              \`<head>\\n  <base href="\${config.basePath}/">\`
            );
          }
        }
      ]
    },
    {
      entry: resolve(__dirname, 'apps/admin/main.ts'),
      outDir: resolve(__dirname, 'dist/admin'),
      outFile: 'bundle.js',
      format: 'esm',
      target: 'es2020',
      minify: true,
      basePath: '/admin'
    }
  ],

  // Preview server
  preview: {
    port: 4173,
    host: 'localhost',
    open: true,
    logging: true,

    clients: [
      {
        root: resolve(__dirname, 'dist/web'),
        basePath: '/web'
      },
      {
        root: resolve(__dirname, 'dist/admin'),
        basePath: '/admin'
      }
    ]
  }
}`))),

      h2('Environment Variables'),
      p('Elit ‡πÇ‡∏´‡∏•‡∏î environment variables ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå .env ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:'),
      pre(code(...codeBlock(`# .env.development
MODE=development
VITE_API_URL=http://localhost:8080
VITE_DEBUG=true

# .env.production
MODE=production
VITE_API_URL=https://api.production.com
VITE_DEBUG=false`))),

      p('‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î:'),
      pre(code(...codeBlock(`// ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ prefix VITE_ ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡πÉ‡∏´‡πâ client
console.log(import.meta.env.VITE_API_URL);
console.log(import.meta.env.VITE_DEBUG);`))),

      h2('CLI Commands'),
      p('‡πÉ‡∏ä‡πâ Elit CLI ‡∏Å‡∏±‡∏ö configuration:'),
      pre(code(...codeBlock(`# Development
npx elit dev                    # ‡πÉ‡∏ä‡πâ config file
npx elit dev --port 8080        # Override config

# Build
npx elit build                  # ‡∏£‡∏±‡∏ô builds ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å config
npx elit build --entry src/app.ts  # Single build (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ config)

# Preview
npx elit preview                # ‡πÉ‡∏ä‡πâ config file
npx elit preview --port 5000    # Override config`))),

      h2('Best Practices'),
      ul(
        li(strong('‡πÉ‡∏ä‡πâ TypeScript config'), ' ‡πÄ‡∏û‡∏∑‡πà‡∏≠ type safety ‡πÅ‡∏•‡∏∞ autocompletion ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô'),
        li(strong('‡πÅ‡∏¢‡∏Å concerns'), ' - ‡πÉ‡∏ä‡πâ multi-client setup ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏û‡∏ï‡πà‡∏≤‡∏á‡πÜ'),
        li(strong('Config ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° environment'), ' - ‡∏™‡∏£‡πâ‡∏≤‡∏á configs ‡πÅ‡∏¢‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö dev/prod'),
        li(strong('‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö builds'), ' - ‡πÉ‡∏ä‡πâ multiple builds ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö entry points ‡∏ï‡πà‡∏≤‡∏á‡πÜ'),
        li(strong('‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏à‡∏≤‡∏Å middleware'), ' - ‡πÄ‡∏û‡∏¥‡πà‡∏° logging, auth ‡πÅ‡∏•‡∏∞ custom processing'),
        li(strong('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ proxy ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á'), ' - ‡πÉ‡∏ä‡πâ client-specific proxy ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô'),
        li(strong('‡πÉ‡∏ä‡πâ SSR ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ç‡∏â‡∏•‡∏≤‡∏î'), ' - ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠ optimize ‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å'),
        li(strong('‡∏ó‡∏î‡∏™‡∏≠‡∏ö preview mode'), ' - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö production builds ‡πÄ‡∏™‡∏°‡∏≠‡∏Å‡πà‡∏≠‡∏ô deploy')
      ),

      h2('‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ'),
      ul(
        li(a({ href: '/elit/blog/18' }, '‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ Elit')),
        li(a({ href: '/elit/blog/17' }, 'Hot Module Replacement ‡∏Å‡∏±‡∏ö Elit')),
        li(a({ href: '/elit/docs' }, '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°')),
        li(a({ href: '/elit/api' }, 'API Reference'))
      ),

      p('‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏û‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏Å‡∏±‡∏ö Elit! üöÄ')
    )
  }
};
