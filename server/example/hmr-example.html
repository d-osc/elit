<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HMR Example - Elit</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 600px;
      width: 100%;
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 2rem;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
    }

    .counter {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 30px 0;
    }

    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
    }

    button:hover {
      background: #5568d3;
      transform: translateY(-2px);
    }

    .count {
      font-size: 3rem;
      font-weight: bold;
      color: #667eea;
      min-width: 100px;
      text-align: center;
    }

    .hmr-status {
      padding: 12px;
      background: #f0fdf4;
      border-left: 4px solid #22c55e;
      border-radius: 4px;
      margin-top: 30px;
      font-size: 14px;
      color: #14532d;
    }

    .info {
      background: #fffbeb;
      border-left: 4px solid #f59e0b;
      padding: 15px;
      border-radius: 4px;
      margin-top: 20px;
      font-size: 14px;
      color: #78350f;
    }

    .message {
      text-align: center;
      padding: 20px;
      background: #f3f4f6;
      border-radius: 8px;
      margin: 20px 0;
      font-size: 1.25rem;
      color: #667eea;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script src="https://unpkg.com/elit@latest/dist/index.global.js"></script>

  <script type="module">
    const { div, h1, p, button, createState, reactive, domNode } = window;

    // Import HMR client
    import { hmr } from 'http://localhost:3000/dist/index.mjs';

    // Create state
    const count = createState(0);
    const message = createState('Try editing this file and save!');

    // Build app
    function buildApp() {
      return div({ className: 'container' },
        h1('üî• HMR Example'),
        p({ className: 'subtitle' }, 'Hot Module Replacement with Elit'),

        div({ className: 'message' },
          reactive(message, msg => msg)
        ),

        div({ className: 'counter' },
          button({ onclick: () => count.value-- }, '‚àí'),
          reactive(count, value =>
            div({ className: 'count' }, value)
          ),
          button({ onclick: () => count.value++ }, '+')
        ),

        reactive(count, value =>
          p({ style: 'text-align: center; margin-top: 20px; color: #666;' },
            value === 0 ? 'Start counting!' :
            value > 0 ? `Count: ${value} üéâ` :
            `Negative: ${value}`
          )
        ),

        div({ className: 'hmr-status' },
          `‚úì HMR is ${hmr.enabled ? 'enabled' : 'disabled'}`
        ),

        div({ className: 'info' },
          'üí° Edit this file and save it. The page will update without refreshing!\n',
          'State is preserved during HMR updates.'
        )
      );
    }

    // Initial render
    domNode.render('#app', buildApp());

    // Enable HMR
    if (hmr.enabled) {
      console.log('[HMR] Hot Module Replacement is active');

      // Accept updates
      hmr.accept(() => {
        console.log('[HMR] Updating app...');

        // Re-render app (state is preserved!)
        domNode.render('#app', buildApp());

        console.log('[HMR] App updated! Count preserved:', count.value);
      });

      // Cleanup before update
      hmr.dispose(() => {
        console.log('[HMR] Cleaning up before update...');
        // Add cleanup code here if needed
      });
    }

    console.log('üé® App initialized!');
    console.log('üìù Try editing the message or styles above');
  </script>
</body>
</html>
